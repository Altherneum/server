#!/bin/bash

clear

[ -r /etc/lsb-release ] && . /etc/lsb-release

if [ -z "$DISTRIB_DESCRIPTION" ] && [ -x /usr/bin/lsb_release ]; then
    DISTRIB_DESCRIPTION=$(lsb_release -s -d)
fi

printf "ğŸ§\tOS\t\t$(uname -o)\n"
printf "ğŸ–²ï¸\tDistribution\t$DISTRIB_DESCRIPTION\n"
printf "ğŸ“Ÿ\tVersion\t\t$(uname -r)\t$(uname -m)\n"

printf "\n"

printf "âŒ›\tUptime\t\t$(uptime -p)\n"
printf "ğŸ“…\tDepuis\t\t$(uptime -s)\n"

printf "\n"

freeh=$(free -h)
freem=$(free -m)
meminfo=$(cat /proc/meminfo)
availmem="$(awk -v arcsize="0" '/^MemAvailable:/ { print $2 + 0 }' <<< "${meminfo}")"
usedmem="$(awk -v availmem="${availmem}" '/^MemTotal:/ { print $2 - availmem }' <<< "${meminfo}")"
totalmem="$(awk '/^MemTotal:/ { print $2 }' <<< "${meminfo}")"
used="$(numfmt --round=down --from-unit=1024 --to=iec <<< "${usedmem}")"
avail="$(numfmt --round=down --from-unit=1024 --to=iec <<< "${availmem}")"
total="$(numfmt --round=down --from-unit=1024 --to=iec <<< "${totalmem}")"
percentage=$(((usedmem*100 / totalmem*100) /100))

printf "ğŸ’»\tCPU\t\t$(uptime | cut -d ',' -f 4-6 | sed -e 's/^[ \t]*//')\n"
printf "ğŸ§ \tRAM\t\t$used / $total : $percentage%%\n"
printf "ğŸ’¾\tSDA\n"
df -hl /dev/sda* | grep -v udev

printf "\n"

printf "ğŸ’¾\tHÃ´te\t\t$(hostname)\n"

printf "\n"

printf "ğŸ“¶\tVPS\t\t$(hostname -I)\n"

printf "\n"

printf "ğŸ‘€\tUtilisateurs\t$(who | sort -u | wc -l)\n"
printf "â¡ï¸\tListe :\n$(who)\n"

printf "\n"

printf "/var/log/wtmp (last) :"
printf "ğŸ‘€\tDerniÃ¨res connexions\tğŸ†—\n"
last | head

printf "\n"

printf "/var/log/btmp (lastb) :"
printf "ğŸ‘€\tDerniÃ¨res connexions\tğŸ”´\n"
lastb | head

printf "\n"

printf "ğŸš¨\tFail2Ban\tğŸ‘®\tSSHD\n"
fail2ban-client status sshd

printf "\n"

printf "ğŸš¨\tFail2Ban\tğŸ‘®\tCode-Server\n"
fail2ban-client status code-server

printf "\n"

printf "ğŸš¨\tFail2Ban\tğŸ‘®\tKeeweb\n"
fail2ban-client status keeweb

printf "\n"

printf "ğŸš¨\tFail2Ban\tğŸ‘®\tForgejo\n"
fail2ban-client status forgejo

printf "\n"

printf "ğŸš¨\tFail2Ban\tğŸ‘®\t404\n"
fail2ban-client status 404

printf "\n"

printf "ğŸš¨\tFail2Ban\tğŸ‘®\t.env\n"
fail2ban-client status env

printf "\n"

printf "ğŸš¨\tFail2Ban\tğŸ‘®\t401\n"
fail2ban-client status 401

printf "\n"

printf "ğŸš¨\tFail2Ban\tğŸ‘®\t405\n"
fail2ban-client status 405

printf "\n"

printf "ğŸš§\tServices\t\tâš¡\t\tğŸ’¤\n"
printf "â˜ï¸\tDiscord\t\t\t$(systemctl is-enabled discord)\t\t$(systemctl check discord)\n"

printf "\n"

printf "ğŸ“©\tsendmail\t\t$(systemctl is-enabled sendmail)\t\t$(systemctl check sendmail)\n"
printf "ğŸ”\topendkim\t\t$(systemctl is-enabled opendkim)\t\t$(systemctl check opendkim)\n"

printf "\n"

printf "ğŸŒ\tApache2\t\t\t$(systemctl is-enabled apache2)\t\t$(systemctl check apache2)\n"
printf "ğŸ’¿\tMySQL\t\t\t$(systemctl is-enabled mysql)\t\t$(systemctl check mysql)\n"

printf "\n"

printf "ğŸ“\tCode-Server\t\t$(systemctl is-enabled code-server@vscode)\t\t$(systemctl check code-server@vscode)\n"

printf "\n"

printf "ğŸ‹\tdocker\t\t\t$(systemctl is-enabled docker)\t\t$(systemctl check docker)\n"

printf "\n"

printf "ğŸ—ƒï¸\tforgejo\t\t\t$(systemctl is-enabled forgejo)\t\t$(systemctl check forgejo)\n"
printf "ğŸ› ï¸\tforgejo-runner\t\t$(systemctl is-enabled forgejo-runner)\t\t$(systemctl check forgejo-runner)\n"

printf "\n"

printf "ğŸš«\tFail2Ban\t\t$(systemctl is-enabled fail2ban)\t\t$(systemctl check fail2ban)\n"

printf "\n"

printf "ğŸ’\tminecraft\t\t$(systemctl is-enabled minecraft)\t$(systemctl check minecraft)\n"

printf "\n"

printf "â˜ ï¸\tminecraft@anarchie\t$(systemctl is-enabled minecraft@anarchie)\t$(systemctl check minecraft@anarchie)\n"
printf "ğŸ˜ï¸\tminecraft@crÃ©atif\t$(systemctl is-enabled minecraft@creatif)\t$(systemctl check minecraft@creatif)\n"
printf "ğŸ‘®\tminecraft@opprison\t$(systemctl is-enabled minecraft@opprison)\t$(systemctl check minecraft@opprison)\n"
printf "âš”ï¸\tminecraft@rpg\t\t$(systemctl is-enabled minecraft@rpg)\t$(systemctl check minecraft@rpg)\n"
printf "ğŸš©\tminecraft@hub\t\t$(systemctl is-enabled minecraft@hub)\t\t$(systemctl check minecraft@hub)\n"
printf "ğŸš¡\tminecraft@proxy\t\t$(systemctl is-enabled minecraft@proxy)\t\t$(systemctl check minecraft@proxy)\n"
printf "ğŸ‡\tminecraft@skyblock\t$(systemctl is-enabled minecraft@skyblock)\t\t$(systemctl check minecraft@skyblock)\n"
printf "ğŸ—\tminecraft@survie\t$(systemctl is-enabled minecraft@survie)\t$(systemctl check minecraft@survie)\n"

printf "\n"

printf "ğŸš§\tminecraft@Test\t\t$(systemctl is-enabled minecraft@test)\t\t$(systemctl check minecraft@test)\n"

printf "\n"