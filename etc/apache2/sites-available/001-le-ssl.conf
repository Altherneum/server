<IfModule mod_ssl.c>

<VirtualHost *:443>
    ServerName altherneum.fr
    ServerAlias www.altherneum.fr docs.altherneum.fr wiki.altherneum.fr info.altherneum.fr

    Redirect 301 / https://doc.altherneum.fr/

    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/altherneum.fr/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/altherneum.fr/privkey.pem
</VirtualHost>

<VirtualHost *:443>
    ServerName git.altherneum.fr
    ServerAlias github.altherneum.fr

    Redirect 301 / https://github.com/altherneum/

    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/altherneum.fr/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/altherneum.fr/privkey.pem
</VirtualHost>

<VirtualHost *:443>
    ServerName windows.altherneum.fr
    ServerAlias microsoft.altherneum.fr fuckwindows.altherneum.fr fuckmicrosoft.altherneum.fr

    Redirect 301 / https://www.youtube.com/watch?v=2zpCOYkdvTQ

    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/altherneum.fr/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/altherneum.fr/privkey.pem
</VirtualHost>

<VirtualHost *:443>
    ServerName code.altherneum.fr
    ServerAlias vscode.altherneum.fr

    RewriteEngine On
    RewriteCond %{HTTP:Connection} Upgrade [NC]
    RewriteCond %{HTTP:Upgrade} websocket [NC]
    RewriteRule /(.*) ws://localhost:6700/$1 [P,L]

    ProxyRequests Off

    <Location />
        AuthType Basic
        AuthName "Please Login"
        AuthUserFile /etc/apache2/.htpasswd
        Require user vscode
        ProxyPreserveHost On
        ProxyPass http://localhost:6700/
        ProxyPassReverse http://localhost:6700/
    </Location>

    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/altherneum.fr/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/altherneum.fr/privkey.pem

    ErrorLog ${APACHE_LOG_DIR}/vscode.error_log
    CustomLog ${APACHE_LOG_DIR}/vscode.access_log combined
</VirtualHost>

<VirtualHost *:443>
    ServerName minecraft.altherneum.fr
    ServerAlias play.altherneum.fr mc.altherneum.fr *.altherneum.fr
    ServerAdmin webmaster@altherneum.fr

    DocumentRoot /var/www/html

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

    <Directory "/var/www/html">

        Options FollowSymLinks
        AllowOverride All
        Require all granted

    </Directory>

    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/altherneum.fr/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/altherneum.fr/privkey.pem
</VirtualHost>

</IfModule>
